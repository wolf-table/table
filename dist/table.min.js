(()=>{var t={200:t=>{(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}e.r(r),e.d(r,{Area:()=>V,Canvas:()=>f,Range:()=>w,Viewport:()=>X,default:()=>Z,eachRanges:()=>p,expr2expr:()=>c,expr2xy:()=>s,findRanges:()=>_,stringAt:()=>a,xy2expr:()=>u});var o="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function i(t){return o.charAt(t%o.length)}function a(t){for(var e=[];t>=0;)e.push(i(t)),t=parseInt(t/o.length+"",10)-1;return e.reverse().join("")}function l(t){for(var e=0,r=0;r<t.length;r++)e=26*e+t.charCodeAt(r)-64;return e-1}function s(t){for(var e="",r="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?r+=t.charAt(n):e+=t.charAt(n).toUpperCase();return[l(e),parseInt(r,10)-1]}function u(t,e){return"".concat(a(t)).concat(e+1)}function c(t,e,r){var o,i=function(t){if(Array.isArray(t))return t}(o=s(t))||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(o)||function(t,e){if(t){if("string"==typeof t)return n(t,2);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,2):void 0}}(o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return u(i[0]+e,i[1]+r)}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var f=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=e;var n=e.getContext("2d");if(!n)throw new Error("getContext(2d) is null");this._ctx=n,this._scale=r,this._target=e}var e,r;return e=t,(r=[{key:"size",value:function(t,e){var r=this._target,n=this._scale;r.style.width="".concat(t,"px"),r.style.height="".concat(e,"px");var o=window.devicePixelRatio;return r.width=Math.floor(t*o),r.height=Math.floor(e*o),this._ctx.scale(o*n,o*n),this}},{key:"prop",value:function(t,e){var r=this;return e?(this._ctx[t]=e,this):"string"==typeof t?this._ctx[t]:(Object.entries(t).forEach((function(t){var e,n=function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(e)||function(t,e){if(t){if("string"==typeof t)return h(t,2);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=n[0],i=n[1];null!=i&&(r._ctx[o]=i)})),this)}},{key:"measureTextWidth",value:function(t){return this.measureText(t).width}},{key:"line",value:function(t,e,r,n){return this.moveTo(t,e).lineTo(r,n).stroke(),this}},{key:"clearRect",value:function(t,e,r,n){return this._ctx.clearRect(t,e,r,n),this}},{key:"fillRect",value:function(t,e,r,n){return this._ctx.fillRect(t,e,r,n),this}},{key:"strokeRect",value:function(t,e,r,n){return this._ctx.strokeRect(t,e,r,n),this}},{key:"fillText",value:function(t,e,r,n){return this._ctx.fillText(t,e,r,n),this}},{key:"strokeText",value:function(t,e,r,n){return this._ctx.strokeText(t,e,r,n),this}},{key:"measureText",value:function(t){return this._ctx.measureText(t)}},{key:"getLineDash",value:function(){return this._ctx.getLineDash()}},{key:"setLineDash",value:function(t){return this._ctx.setLineDash(t),this}},{key:"createLinearGradient",value:function(t,e,r,n){return this._ctx.createLinearGradient(t,e,r,n)}},{key:"createRadialGradient",value:function(t,e,r,n,o,i){return this._ctx.createRadialGradient(t,e,r,n,o,i)}},{key:"createPattern",value:function(t,e){return this._ctx.createPattern(t,e)}},{key:"beginPath",value:function(){return this._ctx.beginPath(),this}},{key:"closePath",value:function(){return this._ctx.closePath(),this}},{key:"moveTo",value:function(t,e){return this._ctx.moveTo(t,e),this}},{key:"lineTo",value:function(t,e){return this._ctx.lineTo(t,e),this}},{key:"bezierCurveTo",value:function(t,e,r,n,o,i){return this._ctx.bezierCurveTo(t,e,r,n,o,i),this}},{key:"quadraticCurveTo",value:function(t,e,r,n){return this._ctx.quadraticCurveTo(t,e,r,n),this}},{key:"arc",value:function(t,e,r,n,o,i){return this._ctx.arc(t,e,r,n,o,i),this}},{key:"arcTo",value:function(t,e,r,n,o){return this._ctx.arcTo(t,e,r,n,o),this}},{key:"ellipse",value:function(t,e,r,n,o,i,a,l){return this._ctx.ellipse(t,e,r,n,o,i,a,l),this}},{key:"rect",value:function(t,e,r,n){return this._ctx.rect(t,e,r,n),this}},{key:"roundRect",value:function(t,e,r,n,o){return this.beginPath().moveTo(t+o,e).arcTo(t+r,e,t+r,e+n,o).arcTo(t+r,e+n,t,e+n,o).arcTo(t,e+n,t,e,o).arcTo(t,e,t+r,e,o).closePath(),this}},{key:"fill",value:function(t){return this._ctx.fill(t),this}},{key:"stroke",value:function(){return this._ctx.stroke(),this}},{key:"clip",value:function(t){return this._ctx.clip(t),this}},{key:"isPointInPath",value:function(t,e,r){return this._ctx.isPointInPath(t,e,r)}},{key:"isPointInStroke",value:function(t,e){return this._ctx.isPointInStroke(t,e)}},{key:"getTransform",value:function(){return this._ctx.getTransform()}},{key:"rotate",value:function(t){return this._ctx.rotate(t),this}},{key:"scale",value:function(t,e){return this._ctx.scale(t,e),this}},{key:"translate",value:function(t,e){return this._ctx.translate(t,e),this}},{key:"setTransform",value:function(t,e,r,n,o,i){return this._ctx.setTransform(t,e,r,n,o,i),this}},{key:"drawImage",value:function(t,e,r){return this._ctx.drawImage(t,e,r),this}},{key:"createImageData",value:function(t,e){return this._ctx.createImageData(t,e)}},{key:"getImageData",value:function(t,e,r,n){return this._ctx.getImageData(t,e,r,n)}},{key:"putImageData",value:function(t,e,r){return this._ctx.putImageData(t,e,r),this}},{key:"save",value:function(){return this._ctx.save(),this}},{key:"restore",value:function(){return this._ctx.restore(),this}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||v(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var w=function(){function t(e,r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.startRow=e,this.startCol=r,this.endRow=n,this.endCol=o}var e,r,n;return e=t,n=[{key:"create",value:function(e,r,n,o){if(void 0!==n&&void 0!==o){var i=e,a=r,l=n,s=o;return e>n&&(i=n,l=e),r>o&&(a=o,s=r),new t(i,a,l,s)}return new t(e,r,e,r)}},{key:"with",value:function(t){var e=t.split(":"),r=d(s(e[0]),2),n=r[0],o=r[1];if(1===e.length)return this.create(o,n);var i=d(s(e[1]),2),a=i[0],l=i[1];return this.create(o,n,l,a)}}],(r=[{key:"start",get:function(){return[this.startRow,this.startCol]}},{key:"end",get:function(){return[this.endRow,this.endCol]}},{key:"rows",get:function(){return this.endRow-this.startRow}},{key:"cols",get:function(){return this.endCol-this.startCol}},{key:"multiple",get:function(){return this.cols>0||this.rows>0}},{key:"containsRow",value:function(t){return this.startRow<=t&&t<=this.endRow}},{key:"containsCol",value:function(t){return this.startCol<=t&&t<=this.endCol}},{key:"contains",value:function(t,e){return this.containsRow(t)&&this.containsCol(e)}},{key:"within",value:function(t){return this.startRow>=t.startRow&&this.startCol>=t.startCol&&this.endRow<=t.endRow&&this.endCol<=t.endCol}},{key:"position",value:function(t){if(this.startRow<=t.startRow&&this.endRow>=t.endRow){if(t.startCol>this.endCol)return"right";if(t.endCol<this.startCol)return"left"}else if(this.startCol<=t.startCol&&this.endCol>=t.endCol){if(t.startRow>this.endRow)return"down";if(t.endRow<this.startRow)return"up"}return"none"}},{key:"intersectsRow",value:function(t,e){return this.startRow<=e&&t<=this.endRow}},{key:"intersectsCol",value:function(t,e){return this.startCol<=e&&t<=this.endCol}},{key:"intersects",value:function(t){var e=t.startRow,r=t.startCol,n=t.endRow,o=t.endCol;return this.intersectsCol(r,o)&&this.intersectsRow(e,n)}},{key:"intersection",value:function(e){return new t(e.startRow<this.startRow?this.startRow:e.startRow,e.startCol<this.startCol?this.startCol:e.startCol,e.endRow>this.endRow?this.endRow:e.endRow,e.endCol>this.endCol?this.endCol:e.endCol)}},{key:"union",value:function(e){return new t(e.startRow<this.startRow?e.startRow:this.startRow,e.startCol<this.startCol?e.startCol:this.startCol,e.endRow>this.endRow?e.endRow:this.endRow,e.endCol>this.endCol?e.endCol:this.endCol)}},{key:"difference",value:function(e){if(!this.intersects(e))return[];var r=this.startRow,n=this.startCol,o=this.endRow,i=this.endCol,a=this.intersection(e);return[new t(r,n,a.startRow-1,i),new t(a.endRow+1,n,o,i),new t(a.startRow,n,a.endRow,a.startCol-1),new t(a.startRow,a.endCol+1,a.endRow,i)].filter((function(t){return t.rows>=0&&t.cols>=0}))}},{key:"touches",value:function(t){return t.startRow===this.startRow&&t.endRow===this.endRow&&(t.endCol+1===this.startCol||this.endCol+1===t.startCol)||t.startCol===this.startCol&&t.endCol===this.endCol&&(t.endRow+1===this.startRow||this.endRow+1===this.startCol)}},{key:"eachRow",value:function(t,e){var r=this.endRow;e&&r>e&&(r=e);for(var n=this.startRow;n<=r;n+=1)t(n);return this}},{key:"eachCol",value:function(t,e){var r=this.endCol;e&&r>e&&(r=e);for(var n=this.startCol;n<=r;n+=1)t(n);return this}},{key:"each",value:function(t){var e=this;return this.eachRow((function(r){e.eachCol((function(e){return t(r,e)}))})),this}},{key:"clone",value:function(){return new t(this.startRow,this.startCol,this.endRow,this.endCol)}},{key:"toString",value:function(){var t=u(this.startCol,this.startRow);return this.multiple&&(t+=":".concat(u(this.endCol,this.endRow))),t}},{key:"equals",value:function(t){return this.startRow===t.startRow&&this.startCol===t.startCol&&this.endRow===t.endRow&&this.endCol===t.endCol}}])&&g(e.prototype,r),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t,e){t&&t.length>0&&t.forEach((function(t){e(w.with(t))}))}function _(t,e){if(t&&t.length>0){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=v(t))){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t);try{for(n.s();!(r=n.n()).done;){var o=r.value,i=w.with(o);if(e(i))return i}}catch(t){n.e(t)}finally{n.f()}}return null}function b(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||m(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){if(t){if("string"==typeof t)return R(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(t,e):void 0}}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function k(t,e,r,n){if(t&&e){var o="";return r&&(o+="italic "),n&&(o+="bold "),"".concat(o," ").concat(e,"pt ").concat(t)}}function C(t,e,r){var n,o,i,a,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Array.isArray(r)?n=o=i=a=r:(n=r.top,o=r.right,i=r.bottom,a=r.left),t.save().beginPath().translate(e.x,e.y);var s=function(t,r){return[[0-r,0,e.width+r,0],[e.width,0,e.width,e.height],[0-r,e.height,e.width+r,e.height],[0,0,0,e.height]][t]};[n,o,i,a].forEach((function(e,r){if(e){var n,o=[],i=1;"thick"===e[0]?i=3:"medium"===e[0]?i=2:"dotted"===e[0]?o=[1,1]:"dashed"===e[0]&&(o=[2,2]);var a=0;l&&(a=i/2),(n=t.prop({strokeStyle:e[1],lineWidth:i}).setLineDash(o)).line.apply(n,b(s(r,a)))}})),t.restore()}function x(t,e,r,n,o,i){var a="";e&&(a="string"==typeof e||"number"==typeof e?i("".concat(e)):i((e.value||"")+"",e.format));var l,s=n.fontSize,u=n.fontFamily,c=n.bold,h=n.italic,f=n.color,d=n.bgcolor,v=n.align,y=n.valign,g=n.underline,w=n.strikethrough,p=n.rotate,_=n.textwrap,R=n.padding;if(t.save().beginPath().translate(r.x,r.y),t.rect(0,0,r.width,r.height).clip(),d&&t.prop("fillStyle",d).fill(),p&&p>0&&t.rotate(p*(Math.PI/180)),void 0!==o){if(t.save(),!o(t,r,e,a))return void t.restore();t.restore()}if(a&&!/^\s*$/.test(a)){t.save().beginPath().prop({textAlign:v,textBaseline:y,font:k(u,s,h,c),fillStyle:f});var C=function(t){if(Array.isArray(t))return t}(l=R||[5,5])||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(l)||m(l,2)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),x=C[0],A=C[1],S=function(t,e,r){switch(t){case"left":return r;case"center":return e/2;case"right":return e-r;default:return 0}}(v,r.width,x),O=a.split("\n"),j=r.width-2*x,T=[];O.forEach((function(e){var r=t.measureTextWidth(e);if(_&&r>j){for(var n={w:0,len:0,start:0},o=0;o<e.length;o+=1)n.w>j&&(T.push(e.substr(n.start,n.len)),n={w:0,len:0,start:o}),n.len+=1,n.w+=t.measureTextWidth(e[o])+1;n.len>0&&T.push(e.substr(n.start,n.len))}else T.push(e)}));var I=s/.75,E=(T.length-1)*I,P=[];g&&P.push("underline"),w&&P.push("strikethrough");var H=function(t,e,r,n,o){switch(t){case"top":return o;case"middle":var i=e/2-r/2,a=n/2+o;return i<a?a:i;case"bottom":return e-o-r;default:return 0}}(y,r.height,E,I,A);T.forEach((function(e){var r=t.measureTextWidth(e);t.fillText(e,S,H),P.forEach((function(e){t.line.apply(t,b(function(t,e,r,n,o,i,a){var l=0;"underline"===t?"top"===r?l=-a:"middle"===r&&(l=-a/2):"strikethrough"===t&&("top"===r?l=-a/2:"bottom"===r&&(l=a/2));var s=0;return"center"===e?s=i/2:"right"===e&&(s=i),[n-s,o-l,n-s+i,o-l]}(e,v,y,S,H,r,s)))})),H+=I})),t.restore()}t.restore()}function A(t){return function(t){if(Array.isArray(t))return O(t)}(t)||j(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){if(t){if("string"==typeof t)return O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function j(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function T(t,e,r){var n,o=function(t){if(Array.isArray(t))return t}(n=e)||j(n)||S(n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],a=o[1],l=o.slice(2),s=[],u=w.with(i),c=r.filter((function(t){return t.intersects(u)}));if(u.intersects(t.range)||c.length>0)if(c.length<=0)s.push([u,t.rect(u),a]);else{var h,f=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=S(t))){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(c);try{var d=function(){var e=h.value;if(!u.within(e)){if("outside"===a||"left"===a||"top"===a||"right"===a||"bottom"===a)return s.push([u,t.rect(u),a]),"break";var r=c.filter((function(t){return!t.equals(e)}));if(u.difference(e).forEach((function(n){if(n.intersects(t.range)){var o=t.rect(n);s.push.apply(s,A(T(t,[n.toString(),a].concat(A(l)),r))),"inside"!==a&&"horizontal"!==a||(n.startRow<e.startRow&&n.endRow<e.startRow?s.push([n,o,"bottom"]):n.startRow>e.startRow&&n.endRow>e.startRow&&s.push([n,o,"top"])),"inside"!==a&&"vertical"!==a||(n.startCol<e.startCol&&n.endCol<e.startCol&&s.push([n,o,"right"]),n.startCol>e.startCol&&n.endCol>e.startCol&&s.push([n,o,"left"]))}})),"all"===a){var n=t.rect(e);u.startRow===e.startRow&&s.push([e,n,"top"]),u.endRow===e.endRow&&s.push([e,n,"bottom"]),u.startCol===e.startCol&&s.push([e,n,"left"]),u.endCol===e.endCol&&s.push([e,n,"right"])}return"break"}u.startRow===e.startRow&&u.startCol===e.startCol&&"inside"!==a&&"horizontal"!==a&&"vertical"!==a&&s.push([e,t.rect(e),"all"===a?"outside":a])};for(f.s();!(h=f.n()).done&&"break"!==d(););}catch(t){f.e(t)}finally{f.f()}}return s}function I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function E(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||H(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(t,e){if(t){if("string"==typeof t)return M(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(t,e):void 0}}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function z(t,e,r){var n=e.width,o=e.color;n>0&&(t.save().beginPath().prop({lineWidth:n-.5,strokeStyle:o}),r(),t.restore())}function W(t,e,r){var n=r.x,o=r.y,i=r.width,a=r.height;z(t,e,(function(){t.translate(n,o).line(i,0,i,a).line(0,a,i,a)}))}function D(t,e,r,n){if(r){var o,i,a,l,s,u,c=function(t){return t},h=n._headerStyle,f=n._headerGridline,d=n._styles,v=n._rowHeader,y=n._colHeader;if("row-header"===t){if(v.width<=0)return;o=v.cell,a=v.merges,i=v.cellRenderer}else if("col-header"===t){if(y.height<=0)return;o=y.cell,a=y.merges,i=y.cellRenderer}else o=n._cell,i=n._cellRenderer,c=n._formatter,h=n._style,f=n._gridline,d=n._styles,a=n._merges,l=n._borders,s=n._row,u=n._col;e.save().translate(r.x,r.y).prop("fillStyle",n._bgcolor).rect(0,0,r.width,r.height).fill().clip();var g=function(t,e,r){var n=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?I(Object(r),!0).forEach((function(e){E(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},h);if(s){var o=s(t);o&&void 0!==o.style&&Object.assign(n,d[o.style])}if(u){var i=u(e);i&&void 0!==i.style&&Object.assign(n,d[i.style])}return r instanceof Object&&void 0!==r.style&&Object.assign(n,d[r.style]),n},w=[],_=[],b=new Set;a&&p(a,(function(t){if(t.intersects(r.range)){var e=o(t.startRow,t.startCol),n=g(t.startRow,t.startCol,e),i=r.rect(t);_.push([e,i,n]),w.push(t),t.each((function(t,e){b.add("".concat(t,"_").concat(e))}))}}));var m=function(r,n,o){"body"===t?(W(e,f,n),x(e,r,n,o,i,c)):(x(e,r,n,o,i,c),W(e,f,n))};r.each((function(t,e,r){if(!b.has("".concat(t,"_").concat(e))){var n=o(t,e);m(n,r,g(t,e,n))}})),_.forEach((function(t){return m.apply(void 0,function(t){if(Array.isArray(t))return M(t)}(e=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||H(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var e})),function(t,e,r,n){r&&r.length>0&&r.forEach((function(r){var o=P(r,4),i=o[2],a=o[3];T(e,r,n).forEach((function(r){var n=P(r,3),o=n[0],l=n[1],s=n[2];!function(t,e,r,n,o,i,a,l){var s=[i,a];"outside"===o||"all"===o?C(t,n,s,!0):"left"===o?C(t,n,{left:s},l):"top"===o?C(t,n,{top:s},l):"right"===o?C(t,n,{right:s},l):"bottom"===o&&C(t,n,{bottom:s},l),"all"!==o&&"inside"!==o&&"horizontal"!==o&&"vertical"!==o||("horizontal"!==o&&r.eachCol((function(n){if(n<r.endCol){var o=r.clone();o.endCol=o.startCol=n,o.intersects(e.range)&&C(t,e.rect(o),{right:s},l)}})),"vertical"!==o&&r.eachRow((function(n){if(n<r.endRow){var o=r.clone();o.endRow=o.startRow=n,o.intersects(e.range)&&C(t,e.rect(o),{bottom:s},l)}})))}(t,e,o,l,s,i,a)}))}))}(e,r,l,w),e.restore()}}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function B(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var V=function(){function t(e,r,n,o,i,a,l){var s=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),B(this,"rowMap",new Map),B(this,"colMap",new Map),B(this,"cellAtCache",null),this.range=e,this.x=r,this.y=n,this.width=o,this.height=i,this.rowHeight=a,this.colWidth=l;var u=0;e.eachRow((function(t){var e=a(t);s.rowMap.set(t,{y:u,height:e}),u+=e})),this.height<=0&&(this.height=u);var c=0;e.eachCol((function(t){var e=l(t);s.colMap.set(t,{x:c,width:e}),c+=e})),this.width<=0&&(this.width=c)}var e,r,n;return e=t,n=[{key:"create",value:function(e,r,n,o,i,a,l,s,u,c){return new t(new w(e,r,n,o),i,a,l,s,u,c)}}],(r=[{key:"containsx",value:function(t){return t>=this.x&&t<this.x+this.width}},{key:"containsy",value:function(t){return t>=this.y&&t<this.y+this.height}},{key:"contains",value:function(t,e){return this.containsx(t)&&this.containsy(e)}},{key:"eachRow",value:function(t){var e=this;this.range.eachRow((function(r){var n=e.rowMap.get(r)||{y:0,height:0},o=n.y,i=n.height;i>0&&t(r,o,i)}))}},{key:"eachCol",value:function(t){var e=this;this.range.eachCol((function(r){var n=e.colMap.get(r)||{x:0,width:0},o=n.x,i=n.width;i>0&&t(r,o,i)}))}},{key:"each",value:function(t){var e=this;this.eachRow((function(r,n,o){e.eachCol((function(e,i,a){t(r,e,{x:i,y:n,width:a,height:o})}))}))}},{key:"rectRow",value:function(t,e){var r,n=this.rowMap,o=this.range,i=0,a=0;t>=o.startRow&&(i=(null===(r=n.get(t))||void 0===r?void 0:r.y)||0);for(var l=t;l<=e;l+=1){var s=this.rowHeight(l);s>0&&(l<o.startRow&&(i-=s),a+=s)}return{x:0,y:i,width:this.width,height:a}}},{key:"rectCol",value:function(t,e){var r,n=this.colMap,o=this.range,i=0,a=0;t>=o.startCol&&(i=(null===(r=n.get(t))||void 0===r?void 0:r.x)||0);for(var l=t;l<=e;l+=1){var s=this.colWidth(l);s>0&&(l<o.startCol&&(i-=s),a+=s)}return{x:i,y:0,width:a,height:this.height}}},{key:"rect",value:function(t){var e=this.rectRow(t.startRow,t.endRow),r=e.y,n=e.height,o=this.rectCol(t.startCol,t.endCol);return{x:o.x,y:r,width:o.width,height:n}}},{key:"cellAt",value:function(t,e){var r=this.cellAtCache;if(null!=r&&t>r.x&&t<=r.x+r.width&&e>r.y&&e<=r.y+r.height)return r;for(var n=this.range,o={row:n.startRow,col:n.startCol,x:this.x,y:this.y,width:0,height:0};o.y<e;){var i=this.rowHeight(o.row++);o.y+=i,o.height=i}for(o.y-=o.height,o.row--;o.x<t;){var a=this.colWidth(o.col++);o.x+=a,o.width=a}return o.x-=o.width,o.col--,this.cellAtCache=o,o}}])&&L(e.prototype,r),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function $(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?F(Object(r),!0).forEach((function(e){K(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function K(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=q(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function U(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||q(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(t,e){if(t){if("string"==typeof t)return N(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?N(t,e):void 0}}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var X=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._render=e;for(var r=[e._rowHeader.width,e._colHeader.height],n=r[0],o=r[1],i=U(e._freeze,2),a=i[0],l=i[1],s=e._startRow,u=e._startCol,c=e._rows,h=e._cols,f=e._width,d=e._height,v=function(t){return e.rowHeightAt(t)},y=function(t){return e.colWidthAt(t)},g=V.create(s,u,a-1,l-1,n,o,0,0,v,y),w=a+e._scrollRows,p=l+e._scrollCols,_=g.height+o,b=w;_<d&&b<c;)_+=v(b),b+=1;for(var m=g.width+n,R=p;m<f&&R<h;)m+=y(R),R+=1;var k=n+g.width,C=o+g.height,x=f-k,A=d-C;R===h&&(x-=f-m),b===c&&(A-=d-_),R-=1,b-=1;var S=V.create(w,p,b,R,k,C,x,A,v,y),O=V.create(s,p,a-1,R,k,o,x,0,v,y),j=V.create(w,u,b,l-1,n,C,0,A,v,y);this.areas=[O,g,j,S];var T=e._rowHeader,I=e._colHeader,E=function(){return I.height/I.rows},P=function(){return T.width/T.cols};this.headerAreas=[V.create(0,O.range.startCol,I.rows-1,O.range.endCol,S.x,0,S.width,0,E,y),V.create(0,g.range.startCol,I.rows-1,g.range.endCol,g.x,0,g.width,0,E,y),V.create(g.range.startRow,0,g.range.endRow,T.cols-1,0,g.y,0,g.height,v,P),V.create(j.range.startRow,0,j.range.endRow,T.cols-1,0,S.y,0,S.height,v,P)]}var e,r;return e=t,(r=[{key:"inAreas",value:function(t,e){var r,n=G(this.areas);try{for(n.s();!(r=n.n()).done;)if(r.value.range.contains(t,e))return!0}catch(t){n.e(t)}finally{n.f()}return!1}},{key:"cellAt",value:function(t,e){var r=this.areas[1],n=U(this.headerAreas,4),o=n[0],i=n[1],a=n[2],l=n[3];if(t<r.x&&e<r.y)return{placement:"all",row:0,col:0,x:0,y:0,width:r.x,height:r.y};if(t<r.x)return $({placement:"row-header"},(a.containsy(e)?a:l).cellAt(t,e));if(e<r.y)return $({placement:"col-header"},(i.containsx(t)?i:o).cellAt(t,e));var s,u=G(this.areas);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(c.contains(t,e))return $({placement:"body"},c.cellAt(t,e))}}catch(t){u.e(t)}finally{u.f()}return null}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Q(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Z=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Q(this,"_bgcolor","#ffffff"),Q(this,"_width",0),Q(this,"_height",0),Q(this,"_scale",1),Q(this,"_rows",100),Q(this,"_cols",26),Q(this,"_rowHeight",22),Q(this,"_colWidth",100),Q(this,"_startRow",0),Q(this,"_startCol",0),Q(this,"_scrollRows",0),Q(this,"_scrollCols",0),Q(this,"_row",(function(){})),Q(this,"_col",(function(){})),Q(this,"_cell",(function(){})),Q(this,"_cellRenderer",(function(){return!0})),Q(this,"_formatter",(function(t){return t})),Q(this,"_merges",[]),Q(this,"_borders",[]),Q(this,"_styles",[]),Q(this,"_gridline",{width:1,color:"#e6e6e6"}),Q(this,"_style",{align:"left",valign:"middle",textwrap:!1,underline:!1,strikethrough:!1,color:"#0a0a0a",bold:!1,italic:!1,rotate:0,fontSize:10,fontFamily:"Source Sans Pro"}),Q(this,"_rowHeader",{width:60,cols:1,cell:function(t,e){return t+1}}),Q(this,"_colHeader",{height:24,rows:1,cell:function(t,e){return a(e)}}),Q(this,"_headerGridline",{width:1,color:"#e6e6e6"}),Q(this,"_headerStyle",{bgcolor:"#f4f5f8cc",align:"center",valign:"middle",textwrap:!0,underline:!1,strikethrough:!1,color:"#585757",bold:!1,italic:!1,rotate:0,fontSize:10,fontFamily:"Source Sans Pro"}),Q(this,"_freeze",[0,0]),Q(this,"_freezeGridline",{width:2,color:"#d8d8d8"}),Q(this,"_viewport",null);var o="string"==typeof e?document.querySelector(e):e;if(!o)throw new Error("target error");this._target=o,this._width=r,this._height=n}var e,r,n;return e=t,n=[{key:"create",value:function(e,r,n){return new t(e,r,n)}}],(r=[{key:"render",value:function(){return this._viewport=new X(this),function(t){var e=t._width,r=t._height,n=t._target,o=t._scale,i=t._viewport,a=t._freeze,l=t._rowHeader,s=t._colHeader;if(i){var u=new f(n,o);u.size(e,r);var c=P(i.areas,4),h=c[0],d=c[1],v=c[2],y=c[3],g=P(i.headerAreas,4),w=g[0],p=g[1],_=g[2],b=g[3];D("body",u,y,t),D("body",u,h,t),D("col-header",u,w,t),D("body",u,v,t),D("row-header",u,b,t),D("body",u,d,t),D("col-header",u,p,t),D("row-header",u,_,t);var m=P(a,2),R=m[0],k=m[1];(k>0||R>0)&&z(u,t._freezeGridline,(function(){k>0&&u.line(0,y.y,e,y.y),R>0&&u.line(y.x,0,y.x,r)}));var C=d.x,x=d.y;if(C>0&&x>0){var A=s.height,S=l.width,O=t._headerStyle.bgcolor;O&&u.save().prop({fillStyle:O}).rect(0,0,S,A).fill().restore(),z(u,t._headerGridline,(function(){u.line(0,A,S,A).line(S,0,S,A)}))}}}(this),this}},{key:"bgcolor",value:function(t){return this._bgcolor=t,this}},{key:"width",value:function(t){return this._width=t,this}},{key:"height",value:function(t){return this._height=t,this}},{key:"scale",value:function(t){return this._scale=t,this}},{key:"rows",value:function(t){return this._rows=t,this}},{key:"cols",value:function(t){return this._cols=t,this}},{key:"rowHeight",value:function(t){return this._rowHeight=t,this}},{key:"colWidth",value:function(t){return this._colWidth=t,this}},{key:"startRow",value:function(t){return this._startRow=t,this}},{key:"startCol",value:function(t){return this._startCol=t,this}},{key:"scrollRows",value:function(t){return this._scrollRows=t,this}},{key:"scrollCols",value:function(t){return this._scrollCols=t,this}},{key:"row",value:function(t){return this._row=t,this}},{key:"col",value:function(t){return this._col=t,this}},{key:"cell",value:function(t){return this._cell=t,this}},{key:"cellRenderer",value:function(t){return this._cellRenderer=t,this}},{key:"formatter",value:function(t){return this._formatter=t,this}},{key:"merges",value:function(t){return this._merges=t,this}},{key:"styles",value:function(t){return this._styles=t,this}},{key:"borders",value:function(t){return this._borders=t,this}},{key:"gridline",value:function(t){return t&&Object.assign(this._gridline,t),this}},{key:"style",value:function(t){return t&&Object.assign(this._style,t),this}},{key:"rowHeader",value:function(t){return t&&Object.assign(this._rowHeader,t),this}},{key:"colHeader",value:function(t){return t&&Object.assign(this._colHeader,t),this}},{key:"headerGridline",value:function(t){return t&&Object.assign(this._headerGridline,t),this}},{key:"headerStyle",value:function(t){return t&&Object.assign(this._headerStyle,t),this}},{key:"freeze",value:function(t){return t&&(this._freeze=s(t).reverse()),this}},{key:"freezeGridline",value:function(t){return t&&Object.assign(this._freezeGridline,t),this}},{key:"rowHeightAt",value:function(t){var e=this._row;if(e){var r=e(t);if(r)return!0===r.hide?0:r.height}return this._rowHeight}},{key:"colWidthAt",value:function(t){var e=this._col;if(e){var r=e(t);if(r)return!0===r.hide?0:r.width}return this._colWidth}},{key:"viewport",get:function(){return this._viewport}}])&&Y(e.prototype,r),n&&Y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();try{var J;window&&((J=window).wolf||(J.wolf={}),window.wolf.table_renderer=Z.create)}catch(e){}t.exports=r})()}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";function t(t){if(Array.isArray(t))return t}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,r){return t(e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(e,r)||o(e,r)||i()}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.r(n),r.d(n,{default:()=>Dt});var h="wolf-table";function f(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function d(e){return t(e)||f(e)||o(e)||i()}function v(){for(var t=document.createDocumentFragment(),e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){var r;r=e instanceof y?e._:"string"==typeof e?document.createTextNode(e):e,t.appendChild(r)})),t}var y=function(){function t(e,r){if(l(this,t),c(this,"_data",new Map),this._=e instanceof Node?e:document.createElement(e),r)if("string"==typeof r)this._.className=r;else if(Array.isArray(r))this._.className=r.join(" ");else for(var n=0,o=Object.entries(r);n<o.length;n++){var i=a(o[n],2),s=i[0];i[1]&&this._.classList.add(s)}}return u(t,[{key:"element",value:function(){return this._}},{key:"data",value:function(t,e){return e?(this._data.set(t,e),this):this._data.get(t)}},{key:"on",value:function(t,e){var r=d(t.split(".")),n=r[0],o=r.slice(1);return this._.addEventListener(n,(function(t){e(t);for(var r=0;r<o.length;r+=1)"stop"===o[r]&&t.stopPropagation(),"prevent"===o[r]&&t.preventDefault()})),this}},{key:"focus",value:function(){return this._.focus(),this}},{key:"value",value:function(t){return void 0!==t?(this._.value=t,this):this._.value}},{key:"textContent",value:function(t){return this._.textContent=t,this}},{key:"html",value:function(t){return this._.innerHTML=t,this}},{key:"attr",value:function(t,e){return e?(this._.setAttribute(t,e),this):this._.getAttribute(t)}},{key:"css",value:function(t,e){var r=this._.style;return e?(r.setProperty(t,e),this):"string"==typeof t?r.getPropertyValue(t):(Object.keys(t).forEach((function(e){var n=t[e];"number"==typeof n&&(n="".concat(n,"px")),r.setProperty(e,n)})),this)}},{key:"rect",value:function(){return this._.getBoundingClientRect()}},{key:"offset",value:function(){var t=this._;return{x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}}},{key:"computedStyle",value:function(){return window.getComputedStyle(this._)}},{key:"show",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.css("display",t?"block":"none"),this}},{key:"hide",value:function(){return this.css("display","none"),this}},{key:"scrollx",value:function(t){var e=this._;return void 0!==t?(e.scrollLeft=t,this):e.scrollLeft}},{key:"scrolly",value:function(t){var e=this._;return void 0!==t?(e.scrollTop=t,this):e.scrollTop}},{key:"after",value:function(){return this._.after(v.apply(void 0,arguments)),this}},{key:"before",value:function(){return this._.before(v.apply(void 0,arguments)),this}},{key:"append",value:function(){return this._.append(v.apply(void 0,arguments)),this}},{key:"remove",value:function(){for(var e=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];n.forEach((function(r){e._.removeChild(r instanceof t?r._:r)}))}},{key:"cloneNode",value:function(){return this._.cloneNode(!0)}},{key:"firstChild",get:function(){var e=this._.firstChild;return e?new t(e):null}}]),t}();function g(t,e){return new y(t,e)}function w(t){return function(t){if(Array.isArray(t))return e(t)}(t)||f(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _(){return g("div","".concat(h,"-overlayer-area"))}var b=function(){function t(e){l(this,t),c(this,"_areaRects",[]),this._areas=[_(),_(),_(),_()],this._headerAreas=[_(),_(),_(),_()],e.append.apply(e,w(this._areas).concat(w(this._headerAreas)))}return u(t,[{key:"area",value:function(t,e){if(e){this._areaRects[t]=e;var r=e.x,n=e.y,o=e.height,i=e.width;return this._areas[t].css({left:r,top:n,width:i,height:o}),this}return this._areas[t]}},{key:"headerArea",value:function(t,e){if(e){var r=e.x,n=e.y,o=e.height,i=e.width;this._headerAreas[t].css({left:r,top:n,width:i,height:o})}return this._headerAreas[t]}},{key:"inAreas",value:function(t){var e,r=t.x,n=t.y,o=t.height,i=r+t.width,a=n+o,l=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(this._areaRects);try{for(l.s();!(e=l.n()).done;){var s=e.value;if(r>=0&&i<=s.width&&n>=0&&a<=s.height)return!0}}catch(t){l.e(t)}finally{l.f()}return!1}}]),t}(),m=r(200),R=r.n(m),k=function(){function t(){l(this,t),c(this,"_",[]),c(this,"_indexes",new Map),c(this,"_formulas",[]),c(this,"_formulaParser",(function(t){return t})),c(this,"_formatter",(function(t){return t}))}return u(t,[{key:"formulaParser",value:function(t){return this._formulaParser=t,this}},{key:"formatter",value:function(t){return this._formatter=t,this}},{key:"load",value:function(t){var e=t.cells;e&&(this._=e,this.resetIndexes())}},{key:"get",value:function(t,e){var r=this._indexes;if(r.has(t)){var n=r.get(t).get(e);return void 0!==n?this._[n]:null}return null}},{key:"remove",value:function(t,e){var r=this._indexes;if(r.has(t)){var n=r.get(t),o=n.get(e);void 0!==o&&(this._.splice(o,1),n.delete(e))}return this}},{key:"set",value:function(t,e,r){var n=this.get(t,e);if(null===n){if(null!=r){var o=this._.push([t,e,r])-1;this.updateIndex(t,e,o),this.addFormula(r,o)}}else{var i=n[2],a=x(i),l=x(r);""===l?(i instanceof Object&&Object.keys(i).length>1?delete i.value:this.remove(t,e),this.resetFormulas()):(i instanceof Object?Object.assign(i,r instanceof Object?r:{value:r}):n[2]=r,l!==a&&this.resetFormulas())}}},{key:"resetIndexes",value:function(){for(var t=this._,e=0;e<t.length;e+=1){var r=a(t[e],3),n=r[0],o=r[1],i=r[2];this.updateIndex(n,o,e),this.addFormula(i,e)}}},{key:"updateIndex",value:function(t,e,r){var n=this._indexes;n.has(t)||n.set(t,new Map),n.get(t).set(e,r)}},{key:"addFormula",value:function(t,e){t instanceof Object&&t.formula&&(t.value=this._formulaParser(t.formula),this._formulas.push(e))}},{key:"resetFormulas",value:function(){var t=this;this._formulas.forEach((function(e){var r=a(t._[e],3)[2];r instanceof Object&&r.formula&&(r.value=t._formulaParser(r.formula))}))}}]),t}();function C(t){return t instanceof Object?t.value:t}function x(t){var e=C(t);return"".concat(null!=e?e:"")}function A(t,e,r,n,o){var i=t.scroll,a="row"===n?0:1,l="row"===n?3:2,s=i[l],u=!1,c=i[a],h=0,f=t.freeze;if(f&&(h=(0,m.expr2xy)(f)["row"===n?1:0]),r>0)if("+"===e)for(var d=c;!(s>=r);d+=1)s+=o(h+d),t.scroll[a]=d+1,u=!0;else for(var v=c;!(s<=r);v-=1){var y=o(h+v-1);if(s-=y,t.scroll[a]=v-1,u=!0,y>0)break}else t.scroll[a]=0,s=0,u=!0;return i[l]=s,u}function S(t,e){var r=t.merges;if(r)for(var n=m.Range.with(e),o=0;o<r.length;o+=1)if(m.Range.with(r[o]).equals(n))return!0;return!1}function O(t,e){var r=m.Range.with(e);if(r.multiple){t.merges||(t.merges=[]);var n=t.merges;n.length<=0||n.forEach((function(t,e){m.Range.with(t).within(r)&&n.splice(e,1)})),n.push(e)}}function j(t,e){var r=t.merges;if(r)for(var n=0;n<r.length;n+=1)if(r[n]===e)return void r.splice(n,1)}function T(t,e){var r=t.merges;if(r)for(var n=0;n<r.length;n+=1){var o=m.Range.with(r[n]);o.intersects(e)&&(e=o.union(e))}return e}function I(t,e,r){for(var n=0,o=t;o<e;o+=1)n+=r(o);return n}function E(t,e){var r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(var n=0;n<r.length;n+=1){var o=r[n],i=t[o],a=e[o];if(void 0===a)return!1;if("string"==typeof i||"number"==typeof i||"boolean"==typeof i){if(i!==a)return!1}else if(Array.isArray(i)){if(i.length!==a.length)return!1;for(var l=0;l<i.length;l+=1)if(!E(i[l],a[l]))return!1}else if("function"!=typeof i&&!Array.isArray(i)&&i instanceof Object&&!E(i,a))return!1}return!0}function P(t,e){if(t.styles||(t.styles=[]),e)for(var r=0;r<t.styles.length;r+=1)if(E(t.styles[r],e))return r;return t.styles.push(e)-1}function H(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.styles[e];return r?Object.assign({},t.style,t.styles[e]||{}):n}function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function z(t,e){t.borders||(t.borders=[]);for(var r=m.Range.with(e[0]),n=t.borders,o=function(t){var o=d(n[t]),i=o[0],a=o.slice(1),l=m.Range.with(i);return l.intersects(r)?(l.within(r)||(n.push(e),l.difference(r).forEach((function(t){n.push([t.toString()].concat(w(a)))}))),n.splice(t,1),{v:void 0}):a.every((function(t,r){return t===e[r+1]}))&&l.touches(r)?(n[t][0]=l.union(r).toString(),{v:void 0}):void 0},i=0;i<n.length;i+=1){var a=o(i);if("object"===M(a))return a.v}n.push(e)}function W(t,e,r){var n=t.cols[e]||{width:t.colWidth};return r?t.cols[e]=Object.assign(n,r):n}function D(t,e,r){if(!r){var n=W(t,e);return n.hide?0:n.width}var o=t.cols;o[e]?o[e].width=r:o[e]={width:r}}function L(t,e,r){var n=t.cols;if(1===arguments.length){var o=n.len*t.colWidth;for(var i in n)if("len"!==i){var a=D(t,parseInt(i,10));a>0&&(o+=a,o-=t.colWidth)}return o}return I(void 0!==e?e:0,void 0!==r?r:n.len,(function(e){return D(t,e)}))}function B(t,e,r){for(;;){if(!W(t,e).hide)return e;e+=r}}function V(t,e,r){var n=t.rows[e]||{height:t.rowHeight};return r?t.rows[e]=Object.assign(n,r):n}function F(t,e,r){if(!r){var n=V(t,e);return n.hide?0:n.height}var o=t.rows;o[e]?o[e].height=r:o[e]={height:r}}function $(t,e,r){var n=t.rows;if(1===arguments.length){var o=n.len*t.rowHeight;for(var i in n)if("len"!==i){var a=F(t,parseInt(i,10));a>0&&(o+=a,o-=t.rowHeight)}return o}return I(void 0!==e?e:0,void 0!==r?r:n.len,(function(e){return F(t,e)}))}function K(t,e,r){for(;;){if(!V(t,e).hide)return e;e+=r}}function G(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t&&e){var n=t.range.position(e.range);if("none"!==n){var o=t.range,i=o.rows,a=o.cols;e.range.each((function(o,l){var s=t.range.startRow,u=t.range.startCol,c=void 0,h=void 0,f=[o-e.range.startRow,l-e.range.startCol];["up","left"].includes(n)&&(f=[e.range.endRow-o,e.range.endCol-l]),"down"===n||"up"===n?i<=0&&r&&(c=n,h=f[0]+1,"up"===n&&(h=0-h)):a<=0&&r&&(c=n,h=f[1]+1,"left"===n&&(h=0-h));var d=f[1]%(a+1),v=f[0]%(i+1);["up","left"].includes(n)?(s=t.range.endRow-v,u=t.range.endCol-d):(s+=v,u+=d),U(s,u,o,l,t,e,c,h)}))}}}function U(t,e,r,n,o,i,a,l){var s=o.cells.get(t,e);if(null!==s&&void 0!==s[2]&&null!==s[2]){var u=s[2];if(u instanceof Object){if(void 0!==(u=Object.assign({},u)).style&&o.cells!==i.cells){var c=Object.assign({},o.data.styles[u.style]);u.style=P(i.data,c)}void 0!==a&&void 0!==l&&(u.formula?u.formula=u.formula.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return["left","top"].includes(a)?(0,m.expr2expr)(t,l,0):(0,m.expr2expr)(t,0,l)})):u.value&&(u.value=q(u.value,l)))}else void 0!==l&&(u=q(u,l));i.cells.set(r,n,u)}else i.cells.remove(t,e)}function q(t,e){return"string"==typeof t?t.replace(/([0-9]+$)|(([0-9]+)[^0-9]+$)/g,(function(t){return t.replace(/[0-9]+/,(function(t){return"".concat(parseInt(t)+e)}))})):t+e}function N(t,e,r){t.addEventListener(e,r)}function X(t,e,r){t.removeEventListener(e,r)}function Y(t,e,r){N(t,"mousemove",e),N(t,"mouseup",(function n(o){r(o),X(t,"mousemove",e),X(t,"mouseup",n)}))}var Q=function(){function t(){l(this,t),c(this,"_events",new Map)}return u(t,[{key:"on",value:function(t,e){var r=this._events;return r.has(t)||r.set(t,[]),r.get(t).push(e),this}},{key:"off",value:function(t,e){var r=this._events;if(r.has(t)){var n=r.get(t);if(e){var o=n.findIndex(it,it===e);-1!==o&&n.splice(o,1)}else n.length=0}return this}},{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o=this._events;return o.has(t)&&o.get(t).forEach((function(t){return t.apply(void 0,r)})),this}}]),t}(),Z=function(){function t(e,r,n,o){var i=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};l(this,t),c(this,"_cell",null),this._type=e,this._minValue=n,this._lineLength=o,this._change=a,this._=g("div","".concat(h,"-resizer ").concat(e)).append(this._hover=g("div","hover").on("mousedown.stop",(function(t){return J(i,t)})),this._line=g("div","line")),r.append(this._)}return u(t,[{key:"show",value:function(t){this._cell=t;var e=this._type,r=t.x,n=t.y,o=t.width,i=t.height;this._.css("left","".concat("row"===e?r:r+o-5,"px")).css("top","".concat("row"===e?n+i-5:n,"px")).show();var a="row"===e?"width":"height";this._hover.css(a,"".concat(t[a],"px")),this._line.css(a,"".concat(this._lineLength(),"px"))}},{key:"hide",value:function(){this._.hide()}}]),t}();function J(t,e){var r=t._type,n=t._cell,o=t._minValue,i=t._,a=t._line,l=t._change,s=0;a.show();var u=function(t){null!==e&&1===t.buttons&&n&&("row"===r?(s+=t.movementY)+n.height>=o?i.css("top","".concat(n.y+n.height+s,"px")):s=o-n.height:(s+=t.movementX)+n.width>=o?i.css("left","".concat(n.x+n.width+s,"px")):s=o-n.width)};N(window,"mousemove",u),N(window,"mouseup",(function t(){X(window,"mousemove",u),X(window,"mouseup",t),a.hide(),i.hide(),n&&0!=s&&l(s,n)}))}function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var et=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l(this,t),c(this,"_rect",null),c(this,"_target",null),this._=g("div","".concat(h,"-").concat(e)),r&&this.show()}return u(t,[{key:"append",value:function(t){return this._.append(t),this}},{key:"offset",value:function(){if(this._rect&&this._target){var t=this._target.offset(),e=this._rect,r=e.x,n=e.y,o=e.width,i=e.height;return{x:r+t.x,y:n+t.y,width:o,height:i}}return null}},{key:"rect",value:function(t){return this._rect=t,this._.css({left:t.x,top:t.y,width:t.width,height:t.height}),this}},{key:"target",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e&&t.append(this._),this._target=t,this}},{key:"show",value:function(){return this._.show(),this}},{key:"clear",value:function(){var t=this._target,e=this._;t&&(t.remove(e),this._target=null)}}]),t}(),rt=function(){function t(e){l(this,t),c(this,"_placement","body"),c(this,"_editable",!1),c(this,"_ranges",[]),c(this,"_rowHeaderRanges",[]),c(this,"_colHeaderRanges",[]),c(this,"_areas",[]),c(this,"_focus",[0,0]),c(this,"_focusRange",null),c(this,"_focusArea",null),c(this,"_move",[0,0]),c(this,"_copyRange",null),c(this,"_copyAreas",[]),c(this,"_autofillRange",null),c(this,"_autofillAreas",[]),c(this,"_autofillTrigger",(function(t){})),this._editable=e}return u(t,[{key:"currentRange",get:function(){return this._ranges.at(-1)}},{key:"placement",value:function(t){return this._placement=t,this}},{key:"focus",value:function(t,e,r){return this._focus=[t,e],this._focusRange=r,this._move=[t,e],this}},{key:"move",value:function(t,e){return this._move=[t,e],this}},{key:"autofillRange",value:function(t){return this._autofillRange=t,this}},{key:"autofillTrigger",value:function(t){return this._autofillTrigger=t,this}},{key:"addRange",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e&&(this._ranges.length=0,this.clear()),this._ranges.push(t),ot(this),this}},{key:"updateLastRange",value:function(t){var e=this._focusRange;e&&(this._ranges.splice(-1,1,t(e)),ot(this))}},{key:"addAreaOutline",value:function(t,e){var r=new et("selector",!0).rect(at(t,2)).target(e);"body"===this._placement&&r.append(g("div","corner").attr("draggable","false").on("mousedown",this._autofillTrigger)),this._areas.push(r)}},{key:"addArea",value:function(t,e){return this._areas.push(new et("selector-area",!0).rect(t).target(e)),this}},{key:"addRowHeaderArea",value:function(t,e){return this._areas.push(new et("selector-area row-header",!0).rect(t).target(e)),this}},{key:"addColHeaderArea",value:function(t,e){return this._areas.push(new et("selector-area col-header",!0).rect(t).target(e)),this}},{key:"addCopyArea",value:function(t,e){return this._copyAreas.push(new et("selector-copy",!0).rect(at(t,2)).target(e)),this}},{key:"addAutofillArea",value:function(t,e){return this._autofillAreas.push(new et("selector-autofill",!0).rect(at(t,2)).target(e)),this}},{key:"setFocusArea",value:function(t,e){return this._focusArea=new et("",!0).rect(t).target(e,!1),this}},{key:"showCopy",value:function(){this._copyRange=this.currentRange}},{key:"clearCopy",value:function(){this._copyRange=null,this._copyAreas.forEach((function(t){t.clear()})),this._copyAreas.length=0}},{key:"clear",value:function(){[this._areas,this._autofillAreas,this._copyAreas].forEach((function(t){t.forEach((function(t){return t.clear()})),t.length=0}))}}]),t}();function nt(t,e,r){t.sort(e);var n=t[0],o=[];1===t.length&&o.push(n);for(var i=1;i<t.length;i+=1){var a=t[i];r(n,a)?n=n.union(a):(o.push(n),n=a)}return t.length>1&&o.push(n),o}function ot(t){var e,r=[],n=[],o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return tt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t._ranges);try{for(o.s();!(e=o.n()).done;){var i=e.value;if(i){var a=i.startRow,l=i.startCol,s=i.endRow,u=i.endCol;(a>=0||s>=0)&&r.push(m.Range.create(a,0,s,0)),(l>=0||u>=0)&&n.push(m.Range.create(0,l,0,u))}}}catch(t){o.e(t)}finally{o.f()}t._rowHeaderRanges=nt(r,(function(t,e){return t.startRow-e.startRow}),(function(t,e){return t.intersectsRow(e.startRow,e.endRow)})),t._colHeaderRanges=nt(n,(function(t,e){return t.startCol-e.startCol}),(function(t,e){return t.intersectsCol(e.startCol,e.endCol)}))}function at(t,e){return{x:t.x-e/2,y:t.y-e/2,width:t.width-e,height:t.height-e}}var lt={vertical:"height",horizontal:"width"},st=function(){function t(e,r){var n=this;l(this,t),c(this,"_value",0),c(this,"_maxValue",0),c(this,"_lastOffset",0),c(this,"_change",null),this._type=e,this._content=g("div","content"),this._=g("div","".concat(h,"-scrollbar ").concat(e)).append(this._content).on("scroll.stop",(function(t){var r=t.target,o=r.scrollTop,i=r.scrollLeft;if(n._change){var a="vertical"===e?o:i,l=a>n._value?"+":"-";n._change(l,a,t),n._value=a}})),r.append(this._)}return u(t,[{key:"value",get:function(){return this._value}},{key:"change",value:function(t){return this._change=t,this}},{key:"scrollBy",value:function(t){return t&&this.scroll(this._value+t),this}},{key:"scrollToStart",value:function(){return this.scroll(0),this}},{key:"scrollToEnd",value:function(){return this.scroll(this._maxValue),this}},{key:"scroll",value:function(t){var e=this._,r=this._type,n=this._maxValue;return void 0!==t?(t<0?t=0:t>n&&(t=n),"vertical"===r?e.scrolly(t):e.scrollx(t),this):"vertical"===r?e.scrolly():e.scrollx()}},{key:"resize",value:function(t,e){if(e>t-1){var r=lt[this._type];this._content.css(r,"".concat(e,"px")),this._.css(r,"".concat(t,"px")).show(),this._maxValue=e-t}else this._.hide();return this}}]),t}();const ut=function(t){var e=t._editor,r=t._selector,n=t._renderer;if(e&&r){var o=r._focusArea,i=r._focus;if(e.visible&&o){var a=o._rect,l=o._target,s=n.viewport;a&&l&&s&&s.inAreas.apply(s,w(i))?e.rect(a).target(l).show():e.rect({x:-100,y:-100,width:0,height:0}).hide()}}},ct=function(t){var e=t._selector;if(e){var r=e._focusRange,n=e._focusArea;if(r&&n){var o=n._rect,i=n._target,a=r.startRow,l=r.startCol,s=t.cell(a,l),u=function(t,e){var r="text";e instanceof Object&&e.type&&(r=e.type);var n=t._editors.get(r);return n.changer((function(e){null!==e&&_t.setCellValue(t,e)})),n.moveChanger((function(e){var r=t._selector;"none"!==e&&r&&(_t.move(t,!0,e,1),t._canvas.focus())})),n}(t,s);t._editor=u,u&&o&&i&&(s&&u.value(s),u.cellIndex(a,l).rect(o).target(i).show())}}},ht=function(t){t._vScrollbar=new st("vertical",t._container).change((function(e,r){(function(t,e,r){return e&&void 0!==r?A(t,e,r,"row",(function(e){return V(t,e).height})):t.scroll[3]})(t._data,e,r)&&(t.render(),_t.reset(t),ut(t))})),t._hScrollbar=new st("horizontal",t._container).change((function(e,r){(function(t,e,r){return e&&void 0!==r?A(t,e,r,"col",(function(e){return W(t,e).width})):t.scroll[2]})(t._data,e,r)&&(t.render(),_t.reset(t),ut(t))}))},ft=function(t){var e=t._contentRect,r=e.x,n=e.y,o=e.height,i=e.width;t._vScrollbar&&t._vScrollbar.resize(t._height(),o+n),t._hScrollbar&&t._hScrollbar.resize(t._width(),i+r)},dt=function(t,e,r){if(e){var n=t._selector,o=t._vScrollbar,i=t._hScrollbar,l=t._data,s=t._renderer.viewport;if(s&&n){var u=a(s.areas,4),c=u[1],h=u[3].range,f=c.range;if(o){var d=function(e,r,n){for(var o=t.rowsHeight(r,n+1),i=0,a=e;i<o;a+=1)i+=t.rowHeight(a);return i};r?e.endRow===r.endRow?e.startRow<r.startRow?e.startRow>f.endRow&&e.startRow<h.startRow&&o.scrollBy(-t.rowsHeight(e.startRow,h.startRow)):e.startRow>r.startRow&&e.startRow>=h.endRow&&o.scrollBy(d(h.startRow,h.endRow,e.startRow)):e.startRow===r.startRow&&(e.endRow>r.endRow?e.endRow>=h.endRow&&o.scrollBy(d(h.startRow,h.endRow,e.endRow)):e.endRow<r.endRow&&e.endRow<h.startRow&&o.scrollBy(-t.rowsHeight(e.endRow,h.startRow))):e.endRow===l.rows.len-1?o.scrollToEnd():0===e.startRow?o.scrollToStart():e.endRow>=h.endRow?o.scrollBy(d(h.startRow,h.endRow,e.endRow)):e.startRow>f.endRow&&e.startRow<h.startRow&&o.scrollBy(-t.rowsHeight(e.startRow,h.startRow))}if(i){var v=function(e,r,n){for(var o=t.colsWidth(r,n+1),i=0,a=e;i<o;a+=1)i+=t.colWidth(a);return i};r?e.endCol===r.endCol?e.startCol<r.startCol?e.startCol>f.endCol&&e.startCol<h.startCol&&i.scrollBy(-t.colsWidth(e.startCol,h.startCol)):e.startCol>r.startCol&&e.startCol>=h.endCol&&i.scrollBy(v(h.startCol,h.endCol,e.startCol)):e.startCol===r.startCol&&(e.endCol>r.endCol?e.endCol>=h.endCol&&i.scrollBy(v(h.startCol,h.endCol,e.endCol)):e.endCol<r.endCol&&e.endCol<h.startCol&&i.scrollBy(-t.colsWidth(e.endCol,h.startCol))):e.endCol===l.cols.len-1?i.scrollToEnd():0===e.startCol?i.scrollToStart():e.endCol>=h.endCol?i.scrollBy(v(h.startCol,h.endCol,e.endCol)):e.startCol>f.endCol&&e.startCol<h.startCol&&i.scrollBy(-t.colsWidth(e.startCol,h.startCol))}}}};function vt(t,e,r,n){var o=t._selector,i=t._data,a=m.Range.create(e,r),l=T(i,a);o&&o.focus(e,r,l).addRange("body"===o._placement?l:a,n)}function yt(t,e,r){var n=t._selector,o=t._data;n&&n.move(e,r).updateLastRange((function(t){return T(o,t.union(m.Range.create(e,r)))}))}function gt(t){var e=t._selector,r=t._overlayer,n=t._renderer,o=n._rowHeader,i=n._colHeader,a=n.viewport;if(e&&a){var l=e._placement;e.clear();var s=o.width,u=i.height,c=function(t,e){var r=t.range;return"body"===l?r.intersects(e):"col-header"===l?r.intersectsCol(e.startCol,e.endCol):"row-header"!==l||r.intersectsRow(e.startRow,e.endRow)},h=function(t,e,r){var n=t.rect(e);return"col-header"===l?((n=t.rectCol(e.startCol,e.endCol)).height+=2,2!==r&&3!==r||(n.y-=2)):"row-header"===l&&((n=t.rectRow(e.startRow,e.endRow)).width+=2,0!==r&&3!==r||(n.x-=2)),n};a.areas.forEach((function(t,n){var o=r._areas[n],i=e._ranges,a=e._focusRange,s=e._copyRange,u=e._autofillRange;i.forEach((function(r,s){var u,f,d,v=c(t,r),y=h(t,r,n);if(v)if(s===i.length-1){if(("all"!==l||t.range.intersects(r))&&e.addAreaOutline(y,o),a){t.range.intersects(a)&&e.setFocusArea(t.rect(a),o);var g=(u=r,f=t.range,d=u.clone(),"all"!==l&&"row-header"!==l||(d.endCol=f.endCol,u.startCol<f.startCol&&(d.startCol=f.startCol)),"all"!==l&&"col-header"!==l||(d.endRow=f.endRow,u.startRow<f.startRow&&(d.startRow=f.startRow)),d),w=g.difference(a);w.length>0?w.forEach((function(r){(v=c(t,r))&&e.addArea(t.rect(r),o)})):"body"===l&&r.equals(a)||e.addArea(h(t,g,n),o)}}else e.addArea(y,o)})),s&&t.range.intersects(s)&&e.addCopyArea(t.rect(s),o),u&&t.range.intersects(u)&&e.addAutofillArea(t.rect(u),o)})),a.headerAreas.forEach((function(t,n){var o=r._headerAreas[n],i=t.width,a=t.height;n<=1?"row-header"===l||"all"===l?e.addColHeaderArea({x:0,y:0,width:i,height:u},o):e._colHeaderRanges.forEach((function(r){t.range.intersectsCol(r.startCol,r.endCol)&&e.addColHeaderArea(t.rectCol(r.startCol,r.endCol),o)})):"col-header"===l||"all"===l?e.addRowHeaderArea({x:0,y:0,width:s,height:a},o):e._rowHeaderRanges.forEach((function(r){t.range.intersectsRow(r.startRow,r.endRow)&&e.addRowHeaderArea(t.rectRow(r.startRow,r.endRow),o)}))}))}}function wt(t,e,r,n){if(!function(t,e){var r=t._selector,n=t._data;if(r){var o=r._autofillRange;if(o)return"up"===e?o.startRow=K(n,o.startRow-1,-1):"down"===e?o.endRow=K(n,o.endRow+1,1):"left"===e?o.startCol=B(n,o.startCol-1,-1):"right"===e&&(o.endCol=B(n,o.endCol+1,1)),dt(t,o),gt(t),!0}return!1}(t,r)){var o=t._selector,i=t._data,l=t._renderer.viewport;if(o&&l){var s=o._focusRange;if(s){var u,c=s.startRow,h=s.startCol,f=s.endRow,d=s.endCol,v=i.rows,y=i.cols,g=a(o._move,2),w=g[0],p=g[1];e||(c=f=w,h=d=p);var _=null===(u=o.currentRange)||void 0===u?void 0:u.clone();n?"up"===r?w=K(i,c-n,-1):"down"===r?w=K(i,f+n,1):"left"===r?p=B(i,h-n,-1):"right"===r&&(p=B(i,d+n,1)):"up"===r?w=0:"down"===r?w=v.len-1:"left"===r?p=0:"right"===r&&(p=y.len-1),w>=0&&w<=v.len-1&&p>=0&&p<=y.len-1&&(e?vt(t,w,p,!0):(yt(t,w,p),o._move=[w,p])),o.placement("body"),dt(t,o.currentRange,e?void 0:_),gt(t)}}}}function pt(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){},o=t._selector,i=t._renderer;if(o){var a=o._placement,l={row:0,col:0};if("all"!==a){var s=t._canvas.rect(),u=s.left,c=s.top,h=[0,0],f=null,d=function(){null!==f&&(clearInterval(f),f=null)},v=function(n){var s,v=0,y=0;n.x>0&&(v=n.x-u),n.y>0&&(y=n.y-c),"row-header"===a&&(v=1),"col-header"===a&&(y=1);var g=null===(s=o.currentRange)||void 0===s?void 0:s.clone();if("CANVAS"===n.target.tagName){var w,p=null===(w=i.viewport)||void 0===w?void 0:w.cellAt(v,y);if(p){var _=p.row,b=p.col;_==l.row&&b===l.col||(e(_,b),"body"===a&&dt(t,r(o),g),gt(t),l.row=_,l.col=b)}d()}else if(null===f){var m=n.x-h[0],R=n.y-h[1];m>=0&&R>=0&&(f=setInterval((function(){var e=r(o);if(e){var n=e.endRow,i=e.endCol;m>R?(wt(t,!1,"right",1),t.isLastRow(n)&&d()):(wt(t,!1,"down",1),t.isLastCol(i)&&d())}}),120))}h=[n.x,n.y]};Y(window,v,(function(){d(),n(o)}))}}}const _t={init:function(t){t._selector=new rt(!!t._editable).autofillTrigger((function(e){var r=t._selector;r&&pt(t,(function(t,e){var n=r.currentRange;if(n){var o=n.clone();if(o.contains(t,e))r.autofillRange(null);else{var i=[o.startRow-t,t-o.endRow,o.startCol-e,e-o.endCol],a=i.indexOf(Math.max.apply(null,i));1===a?(o.startRow=o.endRow+1,o.endRow=t):0===a?(o.endRow=o.startRow-1,o.startRow=t):3===a?(o.startCol=o.endCol+1,o.endCol=e):2===a&&(o.endCol=o.startCol-1,o.startCol=e),r.autofillRange(o)}}}),(function(t){return t._autofillRange}),(function(e){t.copy(e._autofillRange,!0).render(),r.autofillRange(null),gt(t)}))}))},setCellValue:function(t,e){var r=t._selector;r&&(r.clearCopy(),r._ranges.forEach((function(r){r&&r.each((function(r,n){t.cell(r,n,e)}))})),t.render())},addRange:vt,unionRange:yt,reset:gt,move:wt,bindMousemove:pt,showCopy:function(t){t._selector&&(t._selector.showCopy(),gt(t))},clearCopy:function(t){t._selector&&(t._selector.clearCopy(),gt(t))}},bt=function(t){t._rowResizer=new Z("row",t._container,t._minRowHeight,(function(){return t._width()}),(function(e,r){var n=r.row,o=r.height;t.rowHeight(n,o+e).render(),_t.reset(t),t._canvas.focus()})),t._colResizer=new Z("col",t._container,t._minColWidth,(function(){return t._height()}),(function(e,r){var n=r.col,o=r.width;t.colWidth(n,o+e).render(),_t.reset(t),t._canvas.focus()}))};function mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Rt(t){t._canvas.on("mousedown",(function(e){return function(t,e){var r=t._selector,n=t._renderer,o=t._editor,i=t._emitter,a=n.viewport;if(o&&o.changed(),r&&a){var l=e.offsetX,s=e.offsetY,u=e.ctrlKey,c=e.metaKey,h=e.shiftKey,f=a.cellAt(l,s);if(f){i.emit("click",f,e);var d=f.placement,v=f.row,y=f.col;h?_t.unionRange(t,v,y):(r.placement(d),_t.addRange(t,v,y,!(c||u)),"body"===d&&dt(t,r.currentRange)),_t.reset(t),_t.bindMousemove(t,(function(e,r){_t.unionRange(t,e,r)}),(function(t){return t.currentRange}))}}}(t,e)})).on("mousemove",(function(e){return function(t,e){var r=t._rowResizer,n=t._colResizer,o=t._renderer.viewport,i=e.buttons,a=e.offsetX,l=e.offsetY;if(o&&0===i){var s=t._renderer,u=s._rowHeader,c=s._colHeader;if(r&&u.width>0)if(a<u.width&&l>c.height){var h=o.cellAt(a,l);h&&r.show(h)}else r.hide();if(n&&c.height>0)if(l<c.height&&a>u.width){var f=o.cellAt(a,l);f&&n.show(f)}else n.hide()}}(t,e)})).on("keydown",(function(e){return function(t,e){var r=e.ctrlKey,n=e.shiftKey,o=e.metaKey,i=e.altKey,a=e.code,l=null;if("Enter"!==a||r||o||i)if("Tab"!==a||r||o||i)if(a.startsWith("Arrow"))l=a.substring(5).toLowerCase();else if(r||o||i||!(a.startsWith("Key")||a.startsWith("Digit")||["Minus","Equal","Space","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"].includes(a)))if("KeyC"===a&&(r||o)){var s=t._selector;if(t._copyable&&s){var u={},c=s.currentRange;c&&(_t.showCopy(t),["text/plain","text/html"].forEach((function(e){var r=c.toString(),n="text/html"===e?t.toHtml(r):function(t,e){var r=m.Range.with(e),n="";return r.eachRow((function(e){r.eachCol((function(r){var o=t.cellValueString(e,r);o.includes("\n")&&(o='"'.concat(o,'"')),n+="".concat(o,"\t")})),n+="\n"})),n}(t,r);u[e]=new Blob([n],{type:e})})),navigator.clipboard.write([new ClipboardItem(u)]).then((function(){return console.log("clipboard has writed success")}),(function(t){return console.log("clipboard has wirted failure: ",t)})))}}else"KeyV"===a&&(r||o)?t._editable&&navigator.clipboard.read().then((function(e){if(e.length>0){var r=e[0],o=n;o||(o=!kt(r,"text/html",(function(e){t.fill(e).render()}))),o&&kt(r,"text/plain",(function(e){t.fill(function(t){var e,r=[],n=0,o=0,i="",a=0,l=function(){var t;r[t=n]||(r[t]=[]),r[n][o]=i,i=""},s=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return mt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t);try{for(s.s();!(e=s.n()).done;){var u=e.value;"\t"!==u?"\n"!==u||1===a?'"'!==u?"\r"!==u&&(i+=u):a+=1:(l(),n+=1,o=0):(l(),o+=1,a=0)}}catch(t){s.e(t)}finally{s.f()}return o>0&&l(),r.length<=0&&r.push([t]),r}(e)).render()}))}})):"Escape"===a&&_t.clearCopy(t);else ct(t),e.preventDefault();else l=n?"left":"right";else l=n?"up":"down";l&&(_t.move(t,!(a.startsWith("Arrow")&&n),l,o||r?void 0:1),e.preventDefault())}(t,e)})).on("wheel.prevent",(function(e){return function(t,e){var r=e.deltaX,n=e.deltaY,o=t._hScrollbar,i=t._vScrollbar;Math.abs(r)>Math.abs(n)?o&&o.scrollBy(r):i&&i.scrollBy(n)}(t,e)})).on("contextmenu.prevent",(function(t){})).on("dblclick.prevent",(function(){ct(t)}))}function kt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){};return!!t.types.includes(e)&&(t.getType(e).then((function(t){t.text().then((function(t){r(t)}))})),!0)}function Ct(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return xt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function At(t,e,r){if(t.hasAttribute(e)){var n=t.getAttribute(e);null!=n&&r(n)}}function St(t,e,r,n){var o=t.style.getPropertyValue(e),i=null!==o&&""!==o&&o!==r;return i&&n(o),i}function Ot(t,e,r,n){var o=t.style.getPropertyValue(e);o===r&&n(o)}function jt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tt(t){return Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Tt(t)}function It(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tt(t)););return t}function Et(){return Et="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=It(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Et.apply(this,arguments)}function Pt(t,e){return Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Pt(t,e)}function Ht(t,e){if(e&&("object"===M(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return jt(t)}var Mt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pt(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Tt(e);if(r){var o=Tt(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Ht(this,t)});function o(){var t;return l(this,o),c(jt(t=n.call(this,"".concat(h,"-editor"))),"_text",g("textarea","")),c(jt(t),"_textMeasure",g("div","measure")),c(jt(t),"_editing",!1),t._.append(t._text,t._textMeasure),t._text.on("keydown",(function(e){!function(t,e){var r=e.code,n=e.shiftKey,o=e.metaKey,i=e.altKey,a=e.ctrlKey,l=e.target,s=function(e){t._moveChanger(e),t.hide()};"Enter"===r?(a||o||i?(l.value+="\n",t.value(l.value)):s(n?"up":"down"),e.preventDefault()):"Tab"!==r||a||o||i||(s(n?"left":"right"),e.preventDefault())}(jt(t),e)})).on("input",(function(e){var r=e.target.value;t._editing=!0,t._value=r,t._changer(r),zt(jt(t))})),t}return u(o,[{key:"value",value:function(t){return Et(Tt(o.prototype),"value",this).call(this,t),this._text.value(x(t)||""),zt(this),this}},{key:"rect",value:function(t){var e=this;return Et(Tt(o.prototype),"rect",this).call(this,t),t&&setTimeout((function(){var t=e._value,r=0;null!==t&&(r=x(t).length);var n=e._text.element();n.focus(),n.setSelectionRange(r,r)}),0),this}},{key:"hide",value:function(){return Et(Tt(o.prototype),"hide",this).call(this),this._editing=!1,this}}]),o}(function(){function t(e){l(this,t),c(this,"_target",null),c(this,"_rect",null),c(this,"_visible",!1),c(this,"_moveChanger",(function(){})),c(this,"_changer",(function(){})),this._=g("div",e)}return u(t,[{key:"visible",get:function(){return this._visible}},{key:"target",value:function(t){return t.append(this._),this._target=t,this}},{key:"cellIndex",value:function(t,e){return this}},{key:"value",value:function(t){return this._value=t,this}},{key:"changed",value:function(){this._changer(this._value),this.hide()}},{key:"rect",value:function(t){if(t){this._visible=!0,this._rect=t;var e=t.x,r=t.y,n=t.width,o=t.height;this._.css({left:e-1,top:r-1,width:n-2,height:o-2}).show()}return this}},{key:"show",value:function(){return this._.show(),this}},{key:"hide",value:function(){return this._visible=!1,this.value(""),this._.hide(),this}},{key:"moveChanger",value:function(t){return this._moveChanger=t,this}},{key:"changer",value:function(t){return this._changer=t,this}}]),t}());function zt(t){var e=t._,r=t._value,n=t._rect,o=t._textMeasure,i=t._target;if("string"==typeof r){var a=r.replace("\n","<br/>");if(r.endsWith("\n")&&(a+="T"),o.html(a),n&&i){var l=parseInt(o.computedStyle().getPropertyValue("padding")),s=i.offset(),u=s.width-n.x-2,c=s.height-n.y-2;e.css("max-width","".concat(u,"px")),o.css("max-width","".concat(u-2*l,"px"));var h=o.rect(),f=h.width,d=h.height;f>n.width-2&&e.css({width:f}),d>n.height&&d<=c?e.css({height:d}):d<n.height&&e.css({height:n.height-2})}}}var Wt,Dt=function(){function t(e,r,n,o){l(this,t),c(this,"_rendererOptions",{}),c(this,"_copyable",!1),c(this,"_editable",!1),c(this,"_minRowHeight",25),c(this,"_minColWidth",60),c(this,"_contentRect",{x:0,y:0,width:0,height:0}),c(this,"_cells",new k),c(this,"_vScrollbar",null),c(this,"_hScrollbar",null),c(this,"_rowResizer",null),c(this,"_colResizer",null),c(this,"_editor",null),c(this,"_editors",new Map),c(this,"_selector",null),c(this,"_emitter",new Q),this._width=r,this._height=n;var i="string"==typeof e?document.querySelector(e):e;if(null===i)throw new Error("first argument error");if(this._container=g(i,"".concat(h,"-container")).css({height:n(),width:r()}),this._data={rows:{len:100},cols:{len:26},rowHeight:25,colWidth:100,scroll:[0,0,0,0],style:{color:"#333",align:"left",valign:"middle",textwrap:!1,bold:!1,italic:!1,fontFamily:"Roboto",fontSize:10,underline:!1,strikethrough:!1},styles:[],borders:[],merges:[],cells:[]},o){var a=o.minColWidth,s=o.minRowHeight,u=o.renderer,f=o.data;if(a&&(this._minColWidth=a),s&&(this._minRowHeight=s),u&&(this._rendererOptions=u),f){var d=f.cols,v=f.rows,y=f.rowHeight,w=f.colWidth,p=this._data;d&&(p.cols.len=d),v&&(p.rows.len=v),y&&(p.rowHeight=y),w&&(p.colWidth=w)}}var _=document.createElement("canvas");this._canvas=g(_).attr("tabIndex","1"),this._container.append(_),this._renderer=new(R())(_,r(),n()),this._overlayer=new b(this._container),Lt(this),null!=o&&o.selectable&&_t.init(this),null!=o&&o.scrollable&&ht(this),null!=o&&o.resizable&&bt(this),null!=o&&o.editable&&(this._editable=!0),this._copyable=(null==o?void 0:o.copyable)||!1,this._editors.set("text",new Mt),Rt(this)}return u(t,[{key:"contentRect",value:function(){return this._contentRect}},{key:"container",value:function(){return this._container}},{key:"resize",value:function(){this._container.css({height:this._height(),width:this._width()}),this.render()}},{key:"freeze",value:function(t){return this._data.freeze=t,this}},{key:"isMerged",value:function(t){var e=this;if(t)return S(this._data,t);var r=this._selector;return!!r&&r._ranges.every((function(t){return S(e._data,t.toString())}))}},{key:"merge",value:function(t){var e=this;if(t)O(this._data,t);else{var r=this._selector;r&&r._ranges.forEach((function(t){return O(e._data,t.toString())}))}return this}},{key:"unmerge",value:function(t){var e=this;if(t)j(this._data,t);else{var r=this._selector;r&&r._ranges.forEach((function(t){return j(e._data,t.toString())}))}return this}},{key:"row",value:function(t,e){return e?(e.height&&this.rowHeight(t,e.height),V(this._data,t,e),this):V(this._data,t)}},{key:"rowHeight",value:function(t,e){var r=F(this._data,t);return e?(r!==e&&(F(this._data,t,e),this._contentRect.height+=e-r),this):r}},{key:"rowsHeight",value:function(t,e){return $(this._data,t,e)}},{key:"isLastRow",value:function(t){return function(t,e){return t.rows.len-1===e}(this._data,t)}},{key:"col",value:function(t,e){return e?(e.width&&this.colWidth(t,e.width),W(this._data,t,e),this):W(this._data,t)}},{key:"colWidth",value:function(t,e){var r=D(this._data,t);return e?(r!==e&&(D(this._data,t,e),this._contentRect.width+=e-r),this):r}},{key:"colsWidth",value:function(t,e){return L(this._data,t,e)}},{key:"isLastCol",value:function(t){return function(t,e){return t.cols.len-1===e}(this._data,t)}},{key:"formulaParser",value:function(t){return this._cells.formulaParser(t),this}},{key:"formatter",value:function(t){return this._cells.formatter(t),this}},{key:"style",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return H(this._data,t,e)}},{key:"addStyle",value:function(t){return P(this._data,t)}},{key:"clearStyles",value:function(){return this._data.styles.length=0,this}},{key:"addBorder",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return z(this._data,e),this}},{key:"clearBorder",value:function(t){var e,r,n;return e=this._data,r=t,(n=e.borders)&&function(){for(var t=[],e=m.Range.with(r),o=function(r){var o=d(n[r]),a=o[0],l=o.slice(1),s=m.Range.with(a);s.intersects(e)&&(s.within(e)||s.difference(e).forEach((function(e){t.push([e.toString()].concat(w(l)))})),n.splice(r,1),r-=1),i=r},i=0;i<n.length;i+=1)o(i);n.push.apply(n,t)}(),this}},{key:"clearBorders",value:function(){return this._data.borders.length=0,this}},{key:"cell",value:function(t,e,r){var n=this._cells;if(r)return n.set(t,e,r),this;var o=n.get(t,e);return null!=o?o[2]:o}},{key:"cellValue",value:function(t,e){return C(this.cell(t,e))}},{key:"cellValueString",value:function(t,e){return x(this.cell(t,e))}},{key:"render",value:function(){var t=this,e=this._data,r=this._renderer,n=this._overlayer;for(var o in this._rendererOptions){var i=this._rendererOptions[o];i&&r[o](i)}r.scrollRows(e.scroll[0]).scrollCols(e.scroll[1]).merges(e.merges).freeze(e.freeze).styles(e.styles).borders(e.borders).rows(e.rows.len).cols(e.cols.len).row((function(t){return V(e,t)})).col((function(t){return W(e,t)})).cell((function(e,r){return t.cell(e,r)})).formatter(this._cells._formatter).render();var a=r.viewport;return a&&(a.areas.forEach((function(t,e){n.area(e,t)})),a.headerAreas.forEach((function(t,e){n.headerArea(e,t)})),ft(this)),this}},{key:"data",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return t?(Object.assign(this._data,t),this._cells.load(this._data),Lt(this),this):this._data}))},{key:"copy",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this;var n=function(t,e){return{range:"string"==typeof t?m.Range.with(t):t,cells:e._cells,data:e._data}},o=function(t){var e=t._selector;if(!e)return null;var r=e.currentRange;return void 0===r?null:n(r,t)};return G(o(this),e instanceof t?o(e):n(e,this),r),this}},{key:"fill",value:function(t,e){var r=this._selector,n=0,o=0;if(e){var i=a((0,m.expr2xy)(e),2);o=i[0],n=i[1]}else{if(!r)return this;var l=a(r._focus,2);n=l[0],o=l[1]}var s=0,u=0;if(Array.isArray(t)){for(var c=0;c<t.length;c+=1){var h=t[c];u=o+h.length-1;for(var f=0;f<h.length;f+=1)this.cell(n+c,o+f,h[f])}s=n+t.length-1}else if("string"==typeof t){var v=function(t,e,r){var n=a(r,2),o=n[0],i=n[1],l=[0,0];if(e&&e.includes("</table>")){var s=t._data.style,u=document.createElement("template");u.innerHTML=e;var c=[],h=u.content.querySelectorAll("tr");l[0]=o+h.length-1;var f=[];if(h.forEach((function(e,r){var n=e.querySelectorAll("td");0===r&&(l[1]=i+n.length-1);for(var a=null,u=[],h=function(e){var h=n[e],f=r+o,v=e+i;c.length>0&&c.forEach((function(t){t.containsRow(f)&&t.startCol<=v&&(v+=t.cols,t.startRow!==f&&(v+=1))}));var y=(0,m.xy2expr)(v,f),g=1,p=1;if(At(h,"rowspan",(function(t){return g=parseInt(t)})),At(h,"colspan",(function(t){return p=parseInt(t)})),g>1||p>1){var _=m.Range.create(f,v,f+g-1,v+p-1);t.merge(_.toString()),c.push(_)}0===r&&(l[1]+=p-1);var b={};St(h,"background-color","",(function(t){return b.bgcolor=t})),St(h,"color",s.color,(function(t){return b.color=t})),St(h,"text-align",s.align,(function(t){return b.align=t})),St(h,"vertical-align",s.valign,(function(t){return b.valign=t})),Ot(h,"white-space","normal",(function(t){return b.textwrap=!0})),Ot(h,"text-decoration","underline",(function(t){return b.underline=!0})),Ot(h,"text-decoration","line-through",(function(t){return b.strikethrough=!0})),Ot(h,"font-style","italic",(function(t){return b.italic=!0})),St(h,"font-weight","normal",(function(t){("bold"===t||parseInt(t)>=700)&&(b.bold=!0)})),St(h,"font-family",s.fontFamily,(function(t){return b.fontFamily=t})),St(h,"font-size",s.fontSize,(function(t){return b.fontSize=parseInt(t)}));var R=function(t){var e,r=d(t.split(" ").map((function(t){return t.trim()}))),n=r[0],o=r[1],i=r.slice(2),a="thin";if("solid"===o){var l=parseInt(n);n.includes("pt")&&(l=(e=parseInt(n))<=.75?1:e<=1.5?2:e<=2.25?3:e<=3?4:e<=3.75?5:e<=4.5?6:96/72*e),2===l?a="medium":3===l&&(a="thick")}else a=o;return[a,i.join("")]},k=[],C=null;St(h,"border-width","",(function(t){return k.push(t)})),St(h,"border-style","",(function(t){return k.push(t)})),St(h,"border-color","",(function(t){return k.push(t)})),k.length>=3?C=[y,"all"].concat(w(R(k.join(" ")))):St(h,"border","none",(function(t){return C=[y,"all"].concat(w(R(t)))}))||["top","right","bottom","left"].forEach((function(t){St(h,"border-".concat(t),"none",(function(e){return C=[y,t].concat(w(R(e)))}))})),null===a?null!==C&&(a=C):null!==C&&C[1]===a[1]&&C[2]===a[2]&&C[3]===a[3]?a[0]="".concat(a[0].split(":")[0],":").concat(y):(u.push(a),a=C);var x=h.innerHTML.replace(/<br(\/){0,1}>/gi,"\n").replace(/(<([^>]+)>|)/gi,"").replace("&nbsp;"," "),A={};Object.keys(b).length>0&&(A.style=t.addStyle(b)),null===x||/^\s*$/.test(x)||(A.value=x),Object.keys(A).length>0&&t.cell(f,v,A)},v=0;v<n.length;v+=1)h(v);null!=a&&u.push(a);var y=f.at(-1);if(y&&y.length>0)if(1===y.length&&1===u.length&&"all"===y[0][1]&&y[0][1]===u[0][1]&&y[0][2]===u[0][2]&&y[0][3]===u[0][3]){var g=m.Range.with(y[0][0]);g.endRow+=1,y[0][0]=g.toString()}else f.push(u);else f.push(u)})),f.length>0){var v,y=Ct(f);try{for(y.s();!(v=y.n()).done;)v.value.forEach((function(e){return t.addBorder.apply(t,w(e))}))}catch(t){y.e(t)}finally{y.f()}}}return l}(this,t,[n,o]),y=a(v,2);s=y[0],u=y[1]}return(s>0||u>0)&&(_t.unionRange(this,s,u),_t.reset(this)),this}},{key:"toHtml",value:function(t){return function(t,e){var r,n='<table xmlns="http://www.w3.org/1999/xhtml" style="border-spacing: 0; border-collapse: collapse;">',o=m.Range.with(e),i=t._data.merges.map((function(t){return m.Range.with(t)})).filter((function(t){return t.intersects(o)})),l=new Map,s=Ct(t._data.borders);try{var u=function(){var t=a(r.value,4),e=t[0],n=t[1],i=t[2],s=t[3],u=m.Range.with(e);if(u.intersects(o)){var c=u.startRow,h=u.startCol,f=u.endRow,d=u.endCol;u.each((function(t,e){var r=function(t,e){return"dashed"===t||"dotted"===t?"1px ".concat(t," ").concat(e):"".concat("thick"===t?3:"medium"===t?2:1,"px solid ").concat(e)}(i,s),o=[];"all"===n&&o.push("border"),"outside"!==n&&"left"!==n||e===h&&o.push("border-left"),"outside"!==n&&"right"!==n||e===d&&o.push("border-right"),"outside"!==n&&"top"!==n||t===c&&o.push("border-top"),"outside"!==n&&"bottom"!==n||t===f&&o.push("border-bottom"),"inside"!==n&&"vertical"!==n||e>=h&&e<d&&o.push("border-right"),"inside"!==n&&"horizontal"!==n||t>=c&&t<f&&o.push("border-bottom"),o.length>0&&l.set("".concat(t,"_").concat(e),o.map((function(t){return"".concat(t,":").concat(r,";")})).join(""))}))}};for(s.s();!(r=s.n()).done;)u()}catch(t){s.e(t)}finally{s.f()}return n+="<colgroup>",o.eachCol((function(e){n+='<col width="'.concat(t.colWidth(e),'"/>')})),n+="</colgroup>",n+="<tbody>",o.eachRow((function(e){n+='<tr style="height: '.concat(t.rowHeight(e),'px;">'),o.eachCol((function(r){var o,a,s,u=t.cell(e,r),c=m.Range.create(e,r),h=!1,f=1,d=1,v=Ct(i);try{for(v.s();!(o=v.n()).done;){var y=o.value;if(y.startRow===e&&y.startCol===r){f=y.rows+1,d=y.cols+1;break}if(y.intersects(c)){h=!0;break}}}catch(t){v.e(t)}finally{v.f()}if(!h){n+="<td",f>1&&(n+=' rowspan="'.concat(f,'"')),d>1&&(n+=' colspan="'.concat(d,'"'));var g="",w="".concat(e,"_").concat(r);l.has(w)&&(g+=l.get(w)),u&&u instanceof Object&&void 0!==u.style&&(g+=(s="",(a=t.style(u.style,!0)).bgcolor&&(s+="background-color: ".concat(a.bgcolor,";")),a.color&&(s+="color: ".concat(a.color,";")),a.align&&(s+="text-align: ".concat(a.align,";")),a.valign&&(s+="vertical-align: ".concat(a.valign,";")),!0===a.textwrap&&(s+="white-space: normal;"),!0===a.underline&&(s+="text-decoration: underline;"),!0===a.strikethrough&&(s+="text-decoration: line-through;"),!0===a.bold&&(s+="font-weight: bold;"),!0===a.italic&&(s+="font-style: italic;"),a.fontFamily&&(s+="font-family: ".concat(a.fontFamily,";")),a.fontSize&&(s+="font-size: ".concat(a.fontSize,"pt;")),s)),""!==g&&(n+=' style="'.concat(g,'"')),n+=">".concat(t.cellValueString(e,r),"</td>")}})),n+="</tr>"})),n+"</tbody></table>"}(this,t)}},{key:"toArrays",value:function(t){var e=this,r=m.Range.with(t),n=[];return r.eachRow((function(t){var o=[];r.eachCol((function(r){o.push(e.cellValue(t,r))})),n.push(o)})),n}},{key:"onClick",value:function(t){return this._emitter.on("click",t),this}},{key:"addEditor",value:function(t,e){return this._editors.set(t,e),this}}],[{key:"create",value:function(e,r,n,o){return new t(e,r,n,o)}}]),t}();function Lt(t){t._contentRect={x:t._renderer._rowHeader.width,y:t._renderer._colHeader.height,width:L(t._data),height:$(t._data)}}window&&((Wt=window).wolf||(Wt.wolf={}),window.wolf.table=Dt.create)})(),module.exports=n})();